<h6 class="card-title text-muted" *ngIf="showTitle">Formulario de huesped</h6>
<mat-form-field appearance="outline" class="w-100" [hidden]="person">
  <mat-label>Buscar...</mat-label>
  <input matInput #peopleSearchInput placeholder="Escribe para buscar...">
  <button mat-icon-button matSuffix (click)="getPeople(peopleSearchInput.value)">
    <mat-icon matSuffix>search</mat-icon>
  </button>
</mat-form-field>

<div class="text-center">
  <p *ngIf="showPeopleNotFound">No se encontraron resultados.</p>
  <mat-spinner *ngIf="showPeopleLoader" [diameter]="35" class="mx-auto"></mat-spinner>
</div>

<button class="btn-block mb-1" *ngIf="people.length == 0 && !person" (click)="addBlankForm()" mat-button color="primary">
  <mat-icon>add</mat-icon> Crear
</button>

<ul class="list-group list-group-flush" *ngIf="people.length > 0 && !person">
  <li class="list-group-item px-2 guest-item pt-2 pb-1 d-flex align-items-center justify-content-between" *ngFor="let item of people" (dblclick)="selectPerson(item)">
    <div>
      <p class="mb-1">{{item.full_name | titlecase}}</p>
      <p class="mb-1">{{item.document_type.name}}: {{item.document_number}}</p>
    </div>
    <div>
      <button mat-icon-button matTooltip="Seleccionar" color="primary" (click)="addPerson(item)">
        <mat-icon>add</mat-icon>
      </button>
    </div>
  </li>
</ul>

<ul class="list-group list-group-flush" *ngIf="people.length == 0 && !person && guests.length > 0 && showGuestsList">
  <li class="list-group-item px-2 guest-item pt-2 pb-1 d-flex align-items-center justify-content-between" *ngFor="let item of guests; let i = index">
    <div>
      <p class="mb-1">{{item.people.full_name}}</p>
      <p class="mb-1">{{item.people.document_type.name}}: {{item.people.document_number}}</p>
      <p class="mb-0">
        <mat-slide-toggle color="primary" [checked]="item.people.id == peopleClientId ? true : false" (change)="setPeopleClientId($event.checked, item.people.id)">Titular</mat-slide-toggle>
      </p>
    </div>
    <div>
      <button mat-icon-button matTooltip="Editar" color="primary" (click)="selectPerson(item.people)">
        <mat-icon>create</mat-icon>
      </button>
      <button mat-icon-button matTooltip="Eliminar" (click)="removeGuest(i)" color="warn">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </li>
</ul>

<form [formGroup]="form" (ngSubmit)="addPerson()" *ngIf="person" novalidate autocomplete="off">
  <div class="row">
    <div class="col-12 col-md-6 pr-1">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Tipo Doc.</mat-label>
        <mat-select formControlName="document_type_id">
          <mat-option *ngFor="let item of documentTypes" [value]="item.id">{{item.name}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1 pl-0">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>N° Doc.</mat-label>
        <input matInput formControlName="document_number">
      </mat-form-field>
    </div>
    <div class="col-12 col-md-12 pr-1" *ngIf="form.controls['document_type_id'].value == 3">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Raz. Social</mat-label>
        <input matInput formControlName="full_name">
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1" *ngIf="form.controls['document_type_id'].value != 3">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Nombres</mat-label>
        <input matInput formControlName="name">
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1 pl-0" *ngIf="form.controls['document_type_id'].value != 3">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Apellidos</mat-label>
        <input matInput formControlName="last_name">
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1" *ngIf="form.controls['document_type_id'].value != 3">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Genero.</mat-label>
        <mat-select formControlName="gender_id">
          <mat-option *ngFor="let item of genders" [value]="item.id">{{item.name}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1 d-none" [ngClass]="{'pl-0': form.controls['document_type_id'].value != 3}">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Telf.</mat-label>
        <input matInput formControlName="phone_number">
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1" [ngClass]="{'pl-0': form.controls['document_type_id'].value != 3, 'col-md-12' : form.controls['document_type_id'].value == 3}">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Correo</mat-label>
        <input matInput formControlName="email">
      </mat-form-field>
    </div>
    <div class="col-12 col-md-6 pr-1 pl-0 d-none" *ngIf="form.controls['document_type_id'].value != 3">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Cumpleaños</mat-label>
        <input matInput [matDatepicker]="birthdayPicker" formControlName="birthday_date" disabled>
        <mat-datepicker-toggle matSuffix [for]="birthdayPicker"></mat-datepicker-toggle>
        <mat-datepicker #birthdayPicker disabled="false"></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-12">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Dirección</mat-label>
        <input matInput formControlName="address">
      </mat-form-field>
    </div>
    <div class="col-12"></div>
    <div class="col-6">
      <button class="btn-block" type="button" (click)="onFormCancel()" mat-button>
        Cancelar
      </button>
    </div>
    <div class="col-6">
      <button class="btn-block" [disabled]="form.invalid" type="submit" mat-button color="primary">
        <mat-icon>add</mat-icon> Añadir
      </button>
    </div>
    
  </div>
</form>