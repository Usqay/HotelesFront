<div class="row">
    <div class="col-12">
        <app-breadcrumb [items]="['Reportes']" [active_item]="'Reporte de habitiaciones'"></app-breadcrumb>
    </div>
    <div class="col-12 mb-4">
        <mat-accordion>
            <mat-expansion-panel class="shadow-sm">
                <mat-expansion-panel-header>
                    <mat-panel-title class="font-weight-bold text-muted text-uppercase">
                        <span><i class="fa fa-sliders"></i> Filtros</span>
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <form [formGroup]="filtersForm" (keydown.enter)="$event.preventDefault()" novalidate autocomplete="off">
                    <div class="row">
                        <div class="col-12 col-md-3">
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Desde</mat-label>
                                <input matInput formControlName="start_date" [matDatepicker]="StartPicker">
                                <mat-datepicker-toggle matSuffix [for]="StartPicker"></mat-datepicker-toggle>
                                <mat-datepicker #StartPicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-12 col-md-3">
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Hasta</mat-label>
                                <input matInput formControlName="end_date" [matDatepicker]="EndPicker">
                                <mat-datepicker-toggle matSuffix [for]="EndPicker"></mat-datepicker-toggle>
                                <mat-datepicker #EndPicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-12 col-md-3">
                            <mat-form-field appearance="outline" class="w-100">
                              <mat-label>Categoría</mat-label>
                              <mat-select formControlName="room_category_id" (selectionChange)="filterRooms($event.value)">
                                <mat-option value="0">
                                  Todo
                                </mat-option>
                                <mat-option *ngFor="let item of roomCategories" [value]="item.id">
                                  {{item.name}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-12 col-md-3">
                            <mat-form-field appearance="outline" class="w-100">
                              <mat-label>Habitación</mat-label>
                              <mat-select formControlName="room_id">
                                <mat-option value="0">
                                  Todo
                                </mat-option>
                                <mat-option *ngFor="let item of filteredRooms" [value]="item.id">
                                  {{item.name}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                </form>
            </mat-expansion-panel>
        </mat-accordion>
    </div>
    <div class="col-12">
        <div class="row">
            <div class="col-12 col-md-4" *ngFor="let item of roomStatuses">
                <div class="card shadow-sm">
                    <div class="card-header bg-primary pt-2 pb-0 text-center">
                        <h6 class="card-title">{{item.name}}</h6>
                    </div>
                    <div class="card-body text-center p-2">
                        <h5 class="card-text">{{countRoomsByStatusId(item.id)}}</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-6" *ngIf="topRoomsChartOptions">
        <div class="card shadow-sm rounded-sm">
            <div class="card-header px-4 pt-3 pb-1 text-center">
                <h6 class="card-title">Habitaciones más alquiladas</h6>
            </div>
            <div class="card-body p-3">
                <apx-chart 
                [series]="topRoomsChartOptions.series"
                [chart]="topRoomsChartOptions.chart"
                [labels]="topRoomsChartOptions.labels"
                [title]="topRoomsChartOptions.title"
                [theme]="topRoomsChartOptions.theme"
                [responsive]="topRoomsChartOptions.responsive">
                </apx-chart>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-6" *ngIf="incomePerRoomChartOptions">
        <div class="card shadow-sm rounded-sm">
            <div class="card-header px-4 pt-3 pb-1 text-center">
                <h6 class="card-title">Ingresos por habitación</h6>
            </div>
            <div class="card-body p-3">
                <apx-chart 
                [series]="incomePerRoomChartOptions.series"
                [chart]="incomePerRoomChartOptions.chart"
                [dataLabels]="incomePerRoomChartOptions.dataLabels"
                [plotOptions]="incomePerRoomChartOptions.plotOptions"
                [yaxis]="incomePerRoomChartOptions.yaxis"
                [xaxis]="incomePerRoomChartOptions.xaxis"
                [fill]="incomePerRoomChartOptions.fill"
                [title]="incomePerRoomChartOptions.title"></apx-chart>
            </div>
        </div>
    </div>
</div>